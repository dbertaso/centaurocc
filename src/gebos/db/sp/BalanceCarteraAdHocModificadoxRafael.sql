SELECT prestamo.numero AS prestamo, prestamo.saldo_insoluto + prestamo.monto_excedente_sap AS saldo_insoluto, prestamo.capital_vencido AS capital_vencido, prestamo.saldo_insoluto + prestamo.monto_excedente_sap - prestamo.capital_vencido AS Capital_por_vencer, prestamo.interes_vencido AS interes_vencido, prestamo.monto_mora AS interes_mora, prestamo.causado_no_devengado AS interes_devengado_no_vencido, prestamo.interes_diferido_vencido AS interes_diferido_vencido, prestamo.interes_diferido_por_vencer AS interes_diferido_por_vencer, prestamo.capital_pago_parcial AS amortizacion_capital, prestamo.remanente_por_aplicar AS remanente_por_aplicar, prestamo.deuda + prestamo.monto_excedente_sap AS deuda_total, prestamo.exigible AS deuda_exigible, empresa.nombre AS nombre, empresa.rif AS rif, region.nombre AS region, estado.nombre AS estado, municipio.nombre AS municipio, sector_industrial.nombre AS sector_industrial, programa.nombre AS programa_nombre, partida.nombre AS partida_nombre, solicitud.numero AS solicitud_numero, solicitud.descripcion_presupuesto_d3 AS origen_de_fondos FROM public.solicitud solicitud INNER JOIN public.prestamo prestamo ON solicitud.id = prestamo.solicitud_id INNER JOIN public.cliente cliente ON prestamo.cliente_id = cliente.id AND cliente.id = solicitud.cliente_id INNER JOIN public.empresa empresa ON cliente.empresa_id = empresa.id INNER JOIN public.programa programa ON solicitud.programa_id = programa.id INNER JOIN public.tipo_credito tipo_credito ON programa.tipo_credito_id = tipo_credito.id INNER JOIN public.sector_industrial ON empresa.sector_industrial_id = sector_industrial.id INNER JOIN public.municipio municipio ON solicitud.municipio_id = municipio.id INNER JOIN public.estado estado ON municipio.estado_id = estado.id INNER JOIN public.region region ON estado.region_id = region.id INNER JOIN public.partida partida ON prestamo.partida_id = partida.id WHERE prestamo.estatus = 'V' or prestamo.estatus = 'E' or prestamo.estatus = 'P' ORDER BY programa.id, nombre
