select origen_fondo.nombre AS organismo_financiero, programa.nombre AS programa, estado.nombre AS estado, municipio.nombre AS municipio, parroquia.nombre AS parroquia, empresa_direccion.avenida || ',' || empresa_direccion.edificio || ',' || empresa_direccion.zona || ',' || empresa_direccion.referencia AS direccion, solicitud.nombre_proyecto AS nombre_proyecto, empresa.frente AS frente, case when frente = 'N' then 'No Aplica' when frente = 'I' then 'Industrial' when frente = 'T' then 'Turistico' end AS frente, sector_industrial.nombre AS sector_industrial, tipo_cliente.nombre AS tipo_cliente, empresa.nombre AS empresa, empresa.rif AS rif, persona.primer_nombre || ' ' || persona.primer_apellido AS representante, persona.cedula AS cedula_representante, persona_telefono.codigo || '-' || persona_telefono.numero AS telefono_representante, empresa.cantidad_empleados_femeninos AS empleados_femeninos, empresa.cantidad_empleados_masculinos AS empleados_femeninos, empresa.cantidad_empleados_femeninos + empresa.cantidad_empleados_masculinos AS total_empleados, solicitud.fecha_solicitud AS fecha_solicitud, solicitud.numero AS solicitud, solicitud.monto_cliente AS monto_cliente, case when solicitud.estatus = 'T' then 'Tramitando' when solicitud.estatus = 'I' then 'En Directorio' when solicitud.estatus = 'A' then 'Aprobada' when solicitud.estatus = 'C' then 'Aprobada Condicionada' when solicitud.estatus = 'F' then 'Diferido' when solicitud.estatus = 'R' then 'Rechazada' when solicitud.estatus = 'D' then 'En Documentaci√≥n' when solicitud.estatus = 'O' then 'Documentado' when solicitud.estatus = 'S' then 'Condicionando Desembolso' when solicitud.estatus = 'K' then 'Desembolso condicionado' when solicitud.estatus = 'P' then 'Solicitud de Pago' when solicitud.estatus = 'L' then 'Liquidado Parcial' when solicitud.estatus = 'Q' then 'Liquidado' end AS estatus, solicitud.fecha_acta_comite AS acta_comite, solicitud.fecha_acta_directorio AS acta_directorio, solicitud.monto_solicitado AS monto_solicitado, case when modalidad_financiamiento_id = 2 then solicitud.fecha_solicitud end AS fecha_ampliacion, case when modalidad_financiamiento_id = 2 then solicitud.monto_solicitado end AS monto_ampliacion, solicitud.objetivo_proyecto AS observacion, partida.nombre AS partida, prestamo.numero AS prestamo, prestamo.plazo AS plazo_meses, plan_pago.meses_muertos AS meses_muertos, plan_pago.meses_gracia AS meses_gracia, agregar_meses(prestamo.fecha_inicio,plan_pago.meses_muertos) AS fecha_vencimiento_muerto, agregar_meses(prestamo.fecha_inicio,plan_pago.meses_muertos+plan_pago.meses_gracia) AS fecha_vencimiento_muerto, plan_pago.frecuencia_pago AS frecuencia_pago, prestamo.tasa_inicial AS tasa_inicial, prestamo.tasa_vigente AS tasa_vigente, desembolso.fecha_evento_especial AS desembolsos_evento, desembolso.fecha_retiro_caja AS desembolso_retiro_caja, desembolso.monto AS monto_desembolso, prestamo.monto_liquidado AS monto_liquidado, solicitud.monto_solicitado - prestamo.monto_liquidado AS por_desembolsar, prestamo.saldo_insoluto AS saldo_insoluto, prestamo.capital_vencido AS capital_vencido, prestamo.monto_liquidado - prestamo.saldo_insoluto AS armortizacion_acumulada, sum(plan_pago_cuota.interes_corriente + plan_pago_cuota.pago_interes_diferido) AS intereses_cobrados, prestamo.interes_vencido AS interes_vencido from origen_fondo,programa,estado, municipio, parroquia,empresa,empresa_direccion,solicitud,prestamo,cliente,sector_industrial, tipo_cliente, empresa_integrante,empresa_integrante_tipo,persona, persona_telefono, partida, plan_pago, desembolso, plan_pago_cuota where empresa.id = cliente.empresa_id and cliente.id = solicitud.cliente_id and solicitud.id = prestamo.solicitud_id and solicitud.origen_fondo_id = origen_fondo.id and solicitud.programa_id = programa.id and empresa.id = empresa_direccion.empresa_id and municipio.estado_id = estado.id and empresa_direccion.municipio_id = municipio.id and empresa_direccion.parroquia_id = parroquia.id and empresa.sector_industrial_id = sector_industrial.id and cliente.tipo_cliente_id = tipo_cliente.id and empresa_integrante.empresa_id = empresa.id and empresa_integrante_tipo.empresa_integrante_id = empresa_integrante.id and empresa_integrante_tipo.tipo = 'R' and empresa_integrante.persona_id = persona.id and persona.id = persona_telefono.persona_id and prestamo.partida_id = partida.id and prestamo.id = plan_pago.prestamo_id and plan_pago.activo = true and prestamo.id = desembolso.prestamo_id and plan_pago.id = plan_pago_cuota.plan_pago_id and prestamo.estatus in ('V','E','P') GROUP BY solicitud.numero, prestamo.numero, origen_fondo.nombre, programa.nombre, estado.nombre, municipio.nombre, parroquia.nombre,direccion, solicitud.nombre_proyecto, empresa.frente, sector_industrial.nombre, tipo_cliente.nombre, empresa.nombre, representante, persona.cedula,telefono_representante,empresa.cantidad_empleados_femeninos, empresa.cantidad_empleados_masculinos,total_empleados, solicitud.fecha_solicitud, solicitud.monto_cliente, solicitud.estatus, solicitud.fecha_acta_comite, solicitud.fecha_acta_directorio, solicitud.monto_solicitado, solicitud.objetivo_proyecto, partida.nombre, prestamo.plazo,plan_pago.meses_muertos, plan_pago.meses_gracia, plan_pago.frecuencia_pago, prestamo.tasa_inicial, prestamo.tasa_vigente, desembolso.fecha_evento_especial, desembolso.fecha_retiro_caja, desembolso.monto, prestamo.monto_liquidado, por_desembolsar, prestamo.saldo_insoluto, prestamo.capital_vencido, armortizacion_acumulada, empresa.rif, prestamo.interes_vencido, solicitud.modalidad_financiamiento_id, prestamo.fecha_inicio ORDER BY empresa.nombre, partida.nombre	  